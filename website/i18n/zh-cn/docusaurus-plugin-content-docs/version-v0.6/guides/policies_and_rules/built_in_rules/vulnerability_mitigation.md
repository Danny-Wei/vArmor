---
sidebar_position: 3
description: Rules for mitigating specific vulnerabilities.
---

# Vulnerability Mitigation

### `cgroups-lxcfs-escape-mitigation`
:::::info[About This Rule]
Mitigate cgroups & lxcfs escape.

:::note[Description]
If users mount the host's cgroupfs into a container or use lxcfs to provide a resource view for the container, there may be a risk of container escape in both scenarios. Attackers could manipulate cgroupfs from within the container to achieve container escape.

This rule can also be used to defend against [CVE-2022-0492](https://unit42.paloaltonetworks.com/cve-2022-0492-cgroups/) vulnerability exploitation.
:::

:::tip[Principle & Impact]
AppArmor Enforcer prevents writing to：
* `/\*\*/release_agent`
* `/\*\*/devices/device.allow`
* `/\*\*/devices/\*\*/device.allow`
* `/\*\*/devices/cgroup.procs`
* `/\*\*/devices/\*\*/cgroup.procs`
* `/\*\*/devices/task`
* `/\*\*/devices/\*\*/task`

BPF Enforcer prevents writing to：
* `/\*\*/release_agent`
* `/\*\*/devices.allow`
* `/\*\*/cgroup.procs`
* `/\*\*/devices/tasks`
:::

:::danger[Supported Enforcer]
* AppArmor
* BPF
:::
:::::


### `runc-override-mitigation`
:::::info[About This Rule]
Mitigate the ability to override runc to escape.

:::note[Description]
The rule is designed to mitigate vulnerabilities such as [CVE-2019-5736](https://github.com/advisories/GHSA-gxmr-w5mj-v8hh) that exploit container escape by tampering with the host machine's runc.
:::

:::tip[Principle & Impact]
Disallow writing to `/**/runc` files.
:::

:::danger[Supported Enforcer]
* AppArmor
* BPF
:::
:::::


### `dirty-pipe-mitigation`
:::::info[About This Rule]
Mitigate the 'Dirty Pipe' exploit to escape.

:::note[Description]
The rule is designed to defend against attacks exploiting the [CVE-2022-0847 (Dirty Pipe)](https://dirtypipe.cm4all.com/) vulnerability for container escape. You can use this rule to harden container, before upgrading or patching the kernel.

Note: While this rule may cause issues in some software packages, blocking the syscall usually does not have an effect on legitimate applications, since use of this syscall is relatively rare.
:::

:::tip[Principle & Impact]
Disallow calling `splice` syscall.
:::

:::danger[Supported Enforcer]
* Seccomp
:::
:::::