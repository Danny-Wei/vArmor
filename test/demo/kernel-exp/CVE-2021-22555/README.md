# 演示流程

## 1. 创建工作负载
```
kubectl create ns test
kubectl create -f test/demo/kernel-exp/CVE-2021-22555/deploy.yaml
```

## 2. 将内核漏洞利用程序复制到目标容器内
```
pod_name=`kubectl get Pods -n test | grep Running | head -n 1 | awk '{print $1}'`
kubectl cp -n test test/demo/kernel-exp/CVE-2021-22555/exp $pod_name:/tmp/exp
```

## 3. 创建目标容器内的可交互式 shell
```
kubectl exec -n test $pod_name -it -- /bin/sh
```

## 4. 检查环境
```
id
cat /etc/hostname
px ax
```

## 5. 执行内核漏洞利用程序, 并检查漏洞利用效果
```
./tmp/exp
id
cat /etc/hostname
ps ax | grep kubelet
```

## 6. 为工作负载开启沙箱防护
```
kubectl create -f test/demo/kernel-exp/CVE-2021-22555/policy.yaml
kubectl get VarmorPolicy -n test
kubectl rollout restart deployment -n test cve-2021-22555
```

## 7. 重复步骤 2~5

![image](https://github.com/bytedance/vArmor/blob/dev/test/demo/kernel-exp/CVE-2021-22555/demo.gif)
